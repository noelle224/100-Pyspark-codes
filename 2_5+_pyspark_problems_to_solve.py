# -*- coding: utf-8 -*-
"""2. 5+ Pyspark Problems to solve

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1KlLrgzsp9GcUzwFsooTvT_E2WtjRhYT4
"""

!pip install pyspark

import pyspark
from pyspark.sql import SparkSession
spark = SparkSession.builder.appName('Practice-Pyspark').getOrCreate()





"""**1. ICC_WORLDCUP**"""

Teamschema = ['Team1', 'Team2', 'Winner']

Teamlist = [
['India','SL','India'],
['SL','Aus','Aus'],
['SA','Eng','Eng'],
['Eng','NZ','NZ'],
['Aus','India','India'] ]

Teams = spark.createDataFrame(Teamlist,Teamschema)
Teams.show()

from pyspark.sql.functions import when, col, sum

team1win = Teams.withColumn(
    'win_count',
    when(col('Winner') == col('Team1'), 1).otherwise(0)
)
team1 = team1win.select('team1', 'win_count').show()

team2win = Teams.withColumn(
    'win_count',
    when(col('Winner') == col('Team2'), 1).otherwise(0)
)
team2 = team2win.select('team2', 'win_count').show()

# from pyspark.sql.functions import union  # No need to import union from functions
team_union = team1win.select('team1', 'win_count').union(team2win.select('team2', 'win_count')) # Use the DataFrame's union method
team_union.show()

from pyspark.sql.functions import count
team_union = team_union.groupby(col('team1')).agg(
    count('win_count').alias('total_count'), # Changed from count(1) to count('*')
    sum('win_count').alias('win_count'),
)
team_union.show()

team_union = team_union.withColumn(
    'loss_count',
    col('total_count') - col('win_count')
)
team_union.show()

"""**2. CUSTOMER_ORDERS**

![image.png](data:image/png;base64,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)
"""

from pyspark.sql.functions import min, col, when, sum

# Sample data
customer_schema = ['order_id', 'customer_id', 'order_date', 'order_amount']

customer_data = [
    [1, 100, '2022-01-01', 2000],
    [2, 200, '2022-01-01', 2500],
    [3, 300, '2022-01-01', 2100],
    [4, 100, '2022-01-02', 2000],
    [5, 400, '2022-01-02', 2200],
    [6, 500, '2022-01-02', 2700],
    [7, 100, '2022-01-03', 3000],
    [8, 400, '2022-01-03', 1000],
    [9, 600, '2022-01-03', 3000]
]

customer = spark.createDataFrame(customer_data, customer_schema)
customer.show()

# Find the first order date for each customer
first_customer = customer.groupby(col('customer_id')).agg(min(col('order_date')).alias('first_order'))

# Join the original dataframe with the first order dates
customer_joinfirst = customer.join(first_customer, on='customer_id')

# Add columns for first orders and repeated orders
customer_joinfirst = customer_joinfirst.withColumn(
    'First_orders',
    when(col('order_date') == col('first_order'), 1).otherwise(0)
).withColumn(
    'Repeated_orders',
    when(col('order_date') != col('first_order'), 1).otherwise(0)
)

# Cast columns to integer
customer_joinfirst = customer_joinfirst.withColumn("First_orders", col("First_orders").cast("int"))
customer_joinfirst = customer_joinfirst.withColumn("Repeated_orders", col("Repeated_orders").cast("int"))

# Group by 'order_date' and sum the columns
customer_joinfirst = customer_joinfirst.groupby(col('order_date')).agg(
    sum(col("First_orders")).alias('First_orders'),
    sum(col("Repeated_orders")).alias('Repeated_orders')
)

# Show the results
customer_joinfirst.show()

from pyspark.sql import SparkSession
!pip install spark-excel

# Initialize Spark session with the required package
spark = SparkSession.builder \
    .appName("ExcelReader") \
    .config("spark.jars.packages", "com.crealytics:spark-excel_2.12:0.13.5") \
    .getOrCreate()

# Path to your Excel file
path = "/path/to/your/file.xlsx"

# Read the Excel file
orderdf = spark.read.format('com.crealytics.spark.excel') \
    .option('header', 'true') \
    .option('inferSchema', 'true') \
    .option('sheetName', 'Sheet1') \
    .load(path)

# Display the DataFrame
orderdf.show()

Persondfcol = ['PersonID','Name' ,'Score']
Persondf = [
(1, 'Alice'	,88),
(2, 'Bob'	,11),
(3, 'Devis'	,27),
(4, 'Tara'	,45),
(5, 'John'	,63) ]

friendcol = ['pid' , 'fid']
frienddf = [
(1,	2),
(1,	3),
(2,	1),
(2,	3),
(3,	5),
(4,	2),
(4,	3),
(4,	5)
]

Person = spark.createDataFrame(Persondf, Persondfcol)
friend = spark.createDataFrame(frienddf, friendcol)

Person.show()
friend.show()

person_friend1 = Person.join(friend, Person.PersonID == friend.fid, 'inner')
person_friend1 = person_friend1.select('pid', 'Score', 'fid')
person_friend1.show()

person_friend2= person_friend1.join(Person, person_friend1.pid == Person.PersonID, 'inner')
person_friend2 = person_friend2.select('pid', person_friend1.Score, 'Name', 'fid')
person_friend2.show()

from pyspark.sql.functions import col, sum, count
person_friend2 = person_friend2.withColumn('Score', col('Score').cast('int'))
person_friend2 = person_friend2.groupBy('pid','Name').agg(sum('Score'), count('fid'))
person_friend2.show()

person_friend2 = person_friend2.filter(col('sum(Score)') > 100)

person_friend2.show()

"""7. Trips and users"""

from pyspark.sql import SparkSession

# Initialize SparkSession
spark = SparkSession.builder \
    .appName("Trips DataFrame") \
    .getOrCreate()

# Corrected data
trips_data = [
    [1, 1, 10, 1, 'completed', '2013-10-01'],
    [2, 2, 11, 1, 'cancelled_by_driver', '2013-10-01'],
    [3, 3, 12, 6, 'completed', '2013-10-01'],
    [4, 4, 13, 6, 'cancelled_by_client', '2013-10-01'],
    [5, 1, 10, 1, 'completed', '2013-10-02'],
    [6, 2, 11, 6, 'completed', '2013-10-02'],
    [7, 3, 12, 6, 'completed', '2013-10-02'],
    [8, 2, 12, 12, 'completed', '2013-10-03'],
    [9, 3, 10, 12, 'completed', '2013-10-03'],
    [10, 4, 13, 12, 'cancelled_by_driver', '2013-10-03']
]

# Define column names
trips_col = ['id', 'client_id', 'driver_id', 'city_id', 'status', 'request_at']

# Create DataFrame
trips = spark.createDataFrame(trips_data, trips_col)

# Show DataFrame
trips.show()

users_data = [
[1,	    'No', 'client'],
[2,	    'Yes', 'client'],
[3,	    'No', 'client'],
[4,	    'No', 'client'],
[10,	'No', 'driver'],
[11,	'No', 'driver'],
[12,	'No', 'driver'],
[13,	'No', 'driver']
]

users_col = ['users_id','banned','role']

users = spark.createDataFrame(users_data, users_col)
users.show()

user_trips_client = trips.join(users, trips.client_id == users.users_id, 'inner')
user_trips_client.show()

from pyspark.sql import functions as F


# Aliases for clarity
T = trips.alias("T")
U = users.alias("U")
D = users.alias("D")

joined_df = T.join(U, T["client_id"] == U["users_id"], "inner")
joined_df = joined_df.withColumnsRenamed({"U.banned": "client_banned", "U.role": "client_role"})
 # Filter where both the client and driver are not banned using qualified names
filtered_df = joined_df.filter((U["banned"] == "No") & (D["banned"] == "No"))

# Calculate the cancelled rate using qualified column names
cancelled_rate_df = filtered_df.groupBy("request_at") \
    .agg(
        (F.count(F.when(F.col("T.status").isin("cancelled_by_client", "cancelled_by_driver"), 1)) / F.count("*") * 100).alias("cancelled_rate")
    )

# Show the result
cancelled_rate_df.show()

"""1978. Employees Whose Manager Left the Company - Subqueries/Leetcode"""

Employee_col = ['employee_id','name','manager_id','salary' ]

Employee_data = [
[3 , 'Mila'     , 9   ,60301],
[12, 'Antonella', None,31000],
[13, 'Emery'    , None,67084],
[1 , 'Kalel'    , 11  ,21241],
[9 , 'Mikaela'  , None,50937],
[11, 'Joziah'   , 6   ,28485]
]

Employee_df = spark.createDataFrame(Employee_data, Employee_col)
Employee_df.show()

from pyspark.sql.functions import col, broadcast
Employee_list = Employee_df.select(col('employee_id')).rdd.flatMap(lambda x: x).collect()
print(Employee_list)

broadcast_employeelist = spark.sparkContext.broadcast(Employee_list)

Employee_filter = Employee_df.filter(
    (col('salary')<30000)  &
    (~col('manager_id').isin(broadcast_employeelist.value))
    )
Employee_filter.select("employee_id").show()

"""626. Exchange Seats"""

Seat_columns = ['id', 'student']

Seat_data = [
[1, 'Abbot'],
[2, 'Doris'],
[3, 'Emerson'],
[4, 'Green'],
[5, 'Jeames'],
]

seat_df = spark.createDataFrame(Seat_data, Seat_columns)
seat_df.show()

from pyspark.sql.window import Window
from pyspark.sql.functions import lag, lead
from pyspark.sql.functions import when, col, coalesce
windowspec = Window.orderBy('id')

seat_df = seat_df.withColumn('lag',
                             when(col('id')%2 == 0, coalesce(lag('student').over(windowspec), col('student'))).otherwise(coalesce(lead('student').over(windowspec), col('student'))) # Removed .over(windowspec) from col('student')
                             )
seat_df.show()

customer_col = ['customer_id','name','visited_on','amount']

customer_data = [
[1,'Jhon'   ,'2019-01-01',100],
[2,'Daniel' ,'2019-01-02',110],
[3,'Jade'   ,'2019-01-03',120],
[4,'Khaled' ,'2019-01-04',130],
[5,'Winston','2019-01-05',110],
[6,'Elvis'  ,'2019-01-06',140],
[7,'Anna'   ,'2019-01-07',150],
[8,'Maria'  ,'2019-01-08',80 ],
[9,'Jaze'   ,'2019-01-09',110],
[1,'Jhon'   ,'2019-01-10',130],
[3,'Jade'   ,'2019-01-10',150]
]

customer_df = spark.createDataFrame(customer_data, customer_col)
customer_df.show()

from pyspark.sql.functions import col, sum
cte1df = customer_df.groupBy(col('visited_on')).agg(
        sum(col('amount')).alias('amount')
)
cte1df.show()

from pyspark.sql.window import Window
from pyspark.sql.functions import row_number, sum, round

windowspec = Window.orderBy('visited_on')
cte2df = cte1df.withColumn('amount', sum('amount').over(windowspec.rowsBetween(-6, Window.currentRow))) \
               .withColumn('rank', row_number().over(windowspec)) \
               .withColumn('average_amount', round(col('amount')/7,2)) # Changed sum('amount') to col('amount')
cte2df = cte2df.filter(col('rank') > 6)
cte2df.select('visited_on', 'amount','average_amount').show()

860/7

records_col = ['requester_id','accepter_id','accept_date']

Records = [
[1,2,'2016/06/03'],
[1,3,'2016/06/08'],
[2,3,'2016/06/08'],
[3,4,'2016/06/09']
]

records_df = spark.createDataFrame(Records, records_col)
records_df.show()

from pyspark.sql.functions import col, sum
requester_df = records_df.groupBy('requester_id').count()
accepter_df = records_df.groupBy('accepter_id').count()
requunion = requester_df.union(accepter_df)
# Now summing up the count, according to the id's

requunion = requunion.groupBy('requester_id').agg(sum(col('count')).alias('num'))
requunion = requunion.orderBy(col('num').desc())
requunion.show(1)

order_data = [
[1, 1001, 101, '2022-08-21','2022-08-21'],
[2, 1004, 102, '2022-08-21','2022-08-23'],
[3, 1006, 104, '2022-08-25','2022-08-28'],
[4, 1005, 102, '2022-08-25','2022-08-28'],
[5, 1006, 101, '2022-08-26','2022-08-28'],
[6, 1001, 103, '2022-08-24','2022-08-27'],
[7, 1002, 104, '2022-08-21','2022-08-23'],
[8, 1004, 103, '2022-08-23','2022-08-23'],
[9, 1001, 102, '2022-08-25','2022-08-28'],
[10, 1005, 101, '2022-08-26','2022-08-29']
]

order_schema = [
  'order_id',
  'customer_id',
  'delivery_partner_id',
  'order_date',
  'delivery_date'
]

order_df = spark.createDataFrame(order_data, order_schema)
order_df.show()

from pyspark.sql.window import Window
from pyspark.sql.functions import min, col, to_date, datediff, when, sum

windowspec = Window.partitionBy('customer_id').orderBy('order_date')

order_df = order_df.withColumn('first_order', min(col('order_date')).over(windowspec))

order_df = order_df.withColumn('difference',
                               datediff(to_date(col('delivery_date')), to_date(col('order_date'))))

order_df = order_df.withColumn("ratings",
    when(col("order_date") == col("first_order"),
            when(col("difference") <= 2, 100).otherwise(-50))
     .otherwise(
            when(col("difference") <= 2, 50).otherwise(-25)
    )
)

final_ratings = order_df.groupBy("delivery_partner_id").agg(
    sum(col("ratings").cast("int")).alias("total_ratings")
    ).orderBy("delivery_partner_id")
final_ratings.show()

from pyspark.sql.functions import col, to_date, datediff
from pyspark.sql.functions import when

# Calculate the difference between order_date and delivery_date using datediff

order_df.show()

print(order_df.schema)

from pyspark.sql.functions import col, sum
final_ratings = order_df.groupBy("delivery_partner_id") \
                       .agg(sum(col("ratings").cast("int")).alias("total_ratings")) \
                       .orderBy("delivery_partner_id")
final_ratings.show()

userschema = ['username','activity','startDate','endDate']

userdata = [
['Alice',	'Travel'  ,'2020-02-12',	'2020-02-20'],
['Alice',	'Dancing' ,'2020-02-21',	'2020-02-23'],
['Alice',	'Travel' ,'2020-02-24',	    '2020-02-28'],
['Bob'  , 	'Travel' ,'2020-02-11',	    '2020-02-18'] ]

user_df = spark.createDataFrame(userdata, userschema)
user_df.show()

from pyspark.sql.window import Window
from pyspark.sql.functions import col, to_date, rank, count

user_df= user_df.withColumn('startDate', to_date(col('startDate')))

windowspec1 = Window.partitionBy('username').orderBy('startDate')
windowspec2 = Window.partitionBy('username')

changed_df = user_df.withColumn('rank', rank().over(windowspec)).withColumn('count', count('*').over(windowspec2))
result_df = changed_df.filter((col('rank') == 2) | (col('count') == 1)).select('username', 'activity', 'startDate', 'endDate')

result_df.show()

from pyspark.sql import SparkSession
from pyspark.sql.functions import col, to_date, rank, count, year
from pyspark.sql.types import StructType, StructField, LongType, StringType, TimestampType, DateType # Import DateType

# Initialize Spark session
spark = SparkSession.builder \
    .appName("Twitter DataFrame") \
    .getOrCreate()

# Define the schema
schema = StructType([
    StructField("tweet_id", LongType(), True),
    StructField("user_id", LongType(), True),
    StructField("msg", StringType(), True),
    StructField("tweet_date", StringType(), True)
])

# Define the data as a list of tuples
Twitter_data = [
    (214252, 111, 'Am considering taking Tesla private at $420. Funding secured.', '2021-12-30 00:00:00'),
    (739252, 111, 'Despite the constant negative press covfefe', '2022-01-01 00:00:00'),
    (846402, 111, 'Following @NickSinghTech on Twitter changed my life!', '2022-02-14 00:00:00'),
    (241425, 254, 'If the salary is so competitive why wont you tell me what it is?', '2022-03-01 00:00:00'),
    (231574, 148, 'I no longer have a manager. I can''t be managed', '2022-03-23 00:00:00')
]

# Create DataFrame with defined schema
twitter_df = spark.createDataFrame(data=Twitter_data, schema=schema)
twitter_df = twitter_df.withColumn('tweet_date', to_date(col('tweet_date')))
# Show the DataFrame
twitter_df.show()

from pyspark.sql.functions import year

twitter_df = twitter_df.filter(year(col('tweet_date')) == 2022)
result = twitter_df.groupBy('user_id').count()
result.show()

result = result.withColumnRenamed('tweet_count', 'bucket')
result.show()

result.groupBy('bucket').count().show()

med_data_col = ['id','Name', 'location', 'diagnostic', 'visit_date', 'amount']

med_data = [
[1, 'Chris', 'Durach', 'Autism', '05-01-2024', 50000],
[2, 'Richard', 'Auckland', 'Bipolar', '05-03-2024', 20000],
[3, 'Max', 'Munich', 'Autism', '05/02/2024', 50000],
[1, 'Chris', 'Durach', 'Autism', '05/01/2024', 50000],
[1, 'Chris', 'Durach', 'Autism', '05-01-2024', 50000],
[None, '', 'Durach', 'Autism', '', 50000]
]


med_data_df = spark.createDataFrame(med_data, med_data_col)
med_data_df.show()

#Silver Layer
from pyspark.sql.functions import col
med_data_df = med_data_df.filter(col('id').isNotNull())
med_data_df.show()

from pyspark.sql.functions import to_date, col, coalesce

# DROPPING DUPLICATES
med_data_df = med_data_df.dropDuplicates()

# Define the date formats
date_formats = ['dd/MM/yyyy', 'dd-MM-yyyy']  # Corrected month format to MM

# Create a new column 'visit_date_2' by trying each format sequentially
# and using the first valid result
visit_date_2_col = coalesce(*[to_date(col('visit_date'), fmt) for fmt in date_formats])

med_data_df = med_data_df.withColumn('visit_date', visit_date_2_col)

med_data_df.show()

med_data_df = med_data_df.dropDuplicates()
med_data_df.show()

#Gold
from pyspark.sql.functions import col, lit, monotonically_increasing_id

diagnostic_master = med_data_df.select(col('diagnostic')).distinct()
diagnostic_master = diagnostic_master.withColumn('diagnostic_id', monotonically_increasing_id())
diagnostic_master.show()

Facility_master = med_data_df.select(col('location')).distinct()
Facility_master = Facility_master.withColumn('location_id', monotonically_increasing_id())
Facility_master.show()

med_join = med_data_df.join(diagnostic_master, med_data_df.diagnostic == diagnostic_master.diagnostic, 'inner')
med_join = med_join.join(Facility_master, med_join.location == Facility_master.location, 'inner')
med_join.show()

med_data_df = med_join.drop('diagnostic', 'location')
med_data_df.show()